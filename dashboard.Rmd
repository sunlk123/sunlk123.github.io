---
title: "Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)

library(tidyverse)
library(viridis)
library(p8105.datasets)

library(plotly)

data(rest_inspec)
```

## Problem 2

Column {.sidebar}
-----------------------------------------------------------------------
The following charts use data collected from restaurant inspections conducted by the New York City Department of Health and Mental Hygiene. These inspections are conducted annually to ensure that restaurants are in compliance with policies on food handling, food temperature, personal hygiene of restaurant staff and vermin control. 

Chart A 

Column {data-width=750}
-----------------------------------------------------------------------

### Chart A

```{r}
rest_inspec %>%
  filter(.data = ., boro != "Missing") %>%
  mutate(.data = ., 
         as.factor(grade),
         fct_reorder(boro, grade)) %>%
  group_by(boro) %>%
  count(grade) %>%
  filter(.data = ., n != "NA") %>%
  plot_ly(x = ~reorder(grade, -n), y = ~n, color = ~boro, type = "bar")
```

Column {data-width=250}
-----------------------------------------------------------------------
### Number of critical flags by cuisine type in Brooklyn, New York

```{r}
rest_inspec %>%
  filter(.data = ., critical_flag == "Critical", boro == "BROOKLYN") %>%
  group_by(boro, cuisine_description) %>%
  select(.data = ., boro, critical_flag, cuisine_description) %>%
  count(critical_flag) %>%
  arrange(desc(n)) %>%
  filter(.data = ., n > 1000) %>%
  plot_ly(x = ~reorder(cuisine_description, -n), y = ~n, type = "bar") %>%
  layout(xaxis = list(title = "Type of Cuisine",
         yaxis = list(title = "Number of critical flags")))             
```

### Chart C

```{r}
rest_inspec %>%
  filter(.data = ., boro != "Missing", score != "NA") %>%
  group_by(cuisine_description) %>%
  mutate(.data = ., mean_score_cuisine = mean(score)) %>%
  select(.data = ., boro, cuisine_description, mean_score_cuisine) %>% 
  distinct() %>%
  plot_ly(x = ~boro, y = ~mean_score_cuisine, type = "box", color = ~boro)
```
